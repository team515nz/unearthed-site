# 🏺 3D考古发掘分析系统

这是一款基于浏览器的交互式系统，旨在显示、分析和同步来自发掘地层的3D模型。该系统允许将不同的扫描数据组合成一个统一的场景，用于可视化考古研究。

---

## 🛠 操作指南：点击哪里？

### 步骤 1：上传模型

* **点击位置：** 右侧带有📤图标的白色方框内。

* **操作步骤：** 将打开一个窗口，供您从计算机中选择文件。您可以一次选择多个文件（OBJ、STL、GLB、GLTF）。

* **提示：** 系统将显示加载信息，直到模型出现在屏幕中央。

### 步骤 2：管理和控制地层

加载完成后，模型将显示在右侧边栏的列表中。每个模型都有 3 个按钮：

1. **眼睛按钮：** 点击可隐藏/显示模型（当您想要查看某个图层“下方”的内容时非常有用）。

2. **图钉按钮 (📍)：** 点击可开始对齐过程（参见步骤 3）。

3. **垃圾桶按钮：** 点击可从场景中删除模型。

### 步骤 3：对齐模型（对齐）

如果您上传了两个图层，但它们没有完全重叠：

1. 点击要移动的模型旁边的 **图钉 (📍)**。

2. 系统会提示您标记点：

* **第一次点击：** 标记要移动的模型中的特定点。

* **第二次点击：** 标记“固定”模型（已就位的模型）中对应的点。

3. 标记点后，系统将计算并将模型移动到新的位置。

### 步骤 4：裁剪

* **点击位置：** 顶部栏有三个滑块（X、Y、Z）。

* **操作步骤：** 沿轴线左右拖动圆圈。

* **结果：** 模型将被裁剪并逐渐消失，从而显示开挖的横截面。

### 步骤 5：导出和保存

在右侧菜单底部：

1. 从下拉菜单中选择所需的格式（STL 或 GLTF）。

2. 点击蓝色按钮“下载合并模型”。

3. **结果：** 系统会将屏幕上显示的所有内容合并到一个文件中，并将其下载到您的计算机。

---

## ✨ 主要功能

### 🔍 动态图层分析（高级裁剪）

能够使用实时切割平面执行“虚拟开挖”。对于研究地层关系和内部结构至关重要。

### 📍 多点对齐算法

无需外部软件即可实现不同扫描之间的精确空间同步。

### ⚓ 固定锚点 – 基于主锚点的对齐

您可以将一个模型定义为“主模型”（

）。系统将根据边缘和中点的位置为其选择推荐的锚点，并将这些锚点保存在本地存储中。您上传的每个新模型都会尝试根据距离主锚点最近的点自动与主模型对齐。

- 手动定义：选择一个模型，然后单击模型列表中的⚓按钮将其定义为主模型。（您也可以在场景中手动选择主模型点。）

- 推荐选择：系统将自动推荐最合适的模型（尺寸最大的模型）作为主模型。

- 与模型对齐：对于每个模型，您可以手动选择对齐点。单击模型列表中的📌按钮，选择至少3个点，然后单击“与主模型对齐”。用户界面中还有一个**开关**，可以启用“自动对齐”功能，每次上传新模型时都会自动对齐（即，启用后，新模型将自动尝试与主模型对齐）。

### 🎥 交互式 3D 视图

* **引擎：** Three.js

* **移动方式：** 拖动旋转，滚动缩放，右键平移。

### ⛶ 全屏模式

点击右上角的方形图标即可清空屏幕，仅显示带有浮动控件的模型——非常适合在会议或现场展示研究成果。

**技术：** Three.js、JavaScript ES6、CSS Grid/Flexbox、HTML5 文件 API